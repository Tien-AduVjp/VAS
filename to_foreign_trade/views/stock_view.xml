<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<data>

		<record id="act_picking_2_custom_dec_import"
			model="ir.actions.act_window">
			<field name="name">Custom Clearance Request</field>
			<field name="res_model">custom.declaration.import</field>
			<field name="view_mode">tree,form</field>
			<field name="view_id" eval="custom_declaration_import_tree" />
			<field name="search_view_id"
				ref="custom_declaration_import_filter" />
			<field name="context">{'search_default_stock_picking_id': active_id}
			</field>
		</record>

		<record id="act_picking_2_custom_dec_export"
			model="ir.actions.act_window">
			<field name="name">Custom Clearance Request</field>
			<field name="res_model">custom.declaration.export</field>
			<field name="view_mode">tree,form</field>
			<field name="view_id" eval="custom_declaration_export_tree" />
			<field name="search_view_id"
				ref="custom_declaration_export_filter" />
			<field name="context">{'search_default_stock_picking_id': active_id}
			</field>
		</record>

		<record id="picking_custom_dec_po_create_action"
			model="ir.actions.act_window">
			<field name="name">Create Import Custom Clearance Request</field>
			<field name="res_model">custom.declaration.import</field>
			<field name="view_mode">tree,form</field>
			<field name="view_id" eval="custom_declaration_import_form" />
			<field name="context">{'default_stock_picking_id': active_id}</field>
		</record>

		<record id="picking_custom_dec_so_create_action"
			model="ir.actions.act_window">
			<field name="name">Create Export Custom Clearance Request</field>
			<field name="res_model">custom.declaration.export</field>
			<field name="view_mode">tree,form</field>
			<field name="view_id" eval="custom_declaration_export_form" />
			<field name="context">{'default_stock_picking_id': active_id}</field>
		</record>

		<record id="stock_picking_inherit_form" model="ir.ui.view">
			<field name="name">stock.picking.inherit.form</field>
			<field name="model">stock.picking</field>
			<field name="inherit_id" ref="stock.view_picking_form" />
			<field name="arch" type="xml">
				<field name="location_id" position="after">
					<field name="is_custom_clearance" invisible="1" />
					<field name="purchase_id" invisible="1" />
					<field name="sale_id" invisible="1" />
				</field>
				<button name="button_validate" position="after">
					<button name="%(picking_custom_dec_po_create_action)d"
						string="Create Custom Clearance Request" type="action"
						class="oe_highlight"
						groups="to_foreign_trade.group_foreign_trade_user"
						attrs="{'invisible': ['|','|','|',('custom_dec_import_count', '>', 0),('is_custom_clearance', '=', False),('state', 'in', ('draft','cancel')),('purchase_id', '=', False)]}" />
					<button name="%(picking_custom_dec_so_create_action)d"
						string="Create Custom Clearance Request" type="action"
						class="oe_highlight"
						groups="to_foreign_trade.group_foreign_trade_user"
						attrs="{'invisible': ['|','|','|',('custom_dec_export_count', '>', 0),('is_custom_clearance', '=', False),('state', 'in', ('draft','cancel')),('sale_id', '=', False)]}" />
				</button>
				<div name="button_box" position="inside">
					<button name="%(act_picking_2_custom_dec_import)d"
						type="action" class="oe_stat_button" icon="fa-file-o"
						groups="to_foreign_trade.group_foreign_trade_user,stock.group_stock_user"
						attrs="{'invisible': [('custom_dec_import_count', '=', 0)]}">
						<field name="custom_dec_import_count" widget="statinfo"
							string="Custom Declaration" />
					</button>
					<button name="%(act_picking_2_custom_dec_export)d"
						type="action" class="oe_stat_button" icon="fa-file-o"
						groups="to_foreign_trade.group_foreign_trade_user,stock.group_stock_user"
						attrs="{'invisible': [('custom_dec_export_count', '=', 0)]}">
						<field name="custom_dec_export_count" widget="statinfo"
							string="Custom Declaration" />
					</button>
				</div>
			</field>
		</record>

		<record id="view_picking_internal_search" model="ir.ui.view">
			<field name="name">stock.picking.internal.search</field>
			<field name="model">stock.picking</field>
			<field name="inherit_id"
				ref="stock.view_picking_internal_search" />
			<field name="arch" type="xml">
				<xpath expr="//filter[@name='done']" position="after">
					<separator />
					<filter name="custom_dec_required"
						string="Custom Declaration Required"
						domain="[('custom_dec_required','=',True)]"
						help="Show transfers / stock pickings that requires custom declarations" />
				</xpath>
			</field>
		</record>

	</data>
</odoo>