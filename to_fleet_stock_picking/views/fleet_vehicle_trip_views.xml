<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<record id="fleet_trip_form" model="ir.ui.view">
		<field name="name">fleet.vehicle.trip.form</field>
		<field name="model">fleet.vehicle.trip</field>
		<field name="inherit_id"
			ref="to_fleet_operation_planning.fleet_trip_form" />
		<field name="arch" type="xml">
			<xpath expr="//header" position="inside">
				<button name="print_picking" string="Print Pickings"
					type="object" class="oe_highlight" />
				<button name="%(add_stock_picking_action)d" type="action"
				states="draft" string="Add Stock Pickings" class="oe_highlight" />
			</xpath>
			<xpath expr="//field[@name='assistant_ids']" position="after">
				<label for="total_weight" />
				<div>
					<field name="total_weight" class="oe_inline" />
					kg
				</div>
				<label for="total_stowage_volume" />
				<div>
					<field name="total_stowage_volume" class="oe_inline" />
					m3
				</div>
			</xpath>
			<xpath expr="//page[@name='trip_waypoint_ids']"
				position="before">
				<page name="stock_picking_ids" string="Stock Pickings">
					<field name="stock_picking_ids"
						effect="{'remove_only_reference_from_one2many':true}">
						<tree create="0">
							<field name="name" />
							<field name="backorder_id" />
							<field name="origin" />
							<field name="date" />
							<field name="scheduled_date" />
							<field name="state" />
							<button name="action_assign" string="Confirm picking"
								type="object" icon="fa-check text-success"
								attrs="{'invisible': [('state', 'in', ('done', 'cancel', 'confirmed', 'assigned'))]}" />
							<button name="action_cancel" string="Cancel picking"
								type="object" icon="fa-times-circle text-danger"
								attrs="{'invisible': [('state', 'in', ('done', 'cancel'))]}" />
						</tree>
					</field>
				</page>
			</xpath>
			<xpath
				expr="//field[@name='trip_waypoint_ids']/tree/field[@name='address_id']"
				position="after">
				<field name="picked_stock_picking_ids" widget="many2many_tags" />
				<field name="stock_picking_ids" widget="many2many_tags" />
			</xpath>
			<xpath expr="//field[@name='trip_waypoint_ids']/tree"
				position="after">
				<form name="trip_waypoint_ids">
					<group>
						<group>
							<field name="address_id" />
							<field name="street" />
							<field name="street2" />
							<field name="city" />
							<field name="state_id" />

						</group>
						<group>
							<field name="stop_duration" />
						</group>
					</group>
					<group>
						<field name="stock_picking_ids">
							<tree>
								<field name="name" />
								<field name="backorder_id" />
								<field name="origin" />
								<field name="date" />
								<field name="scheduled_date" />
								<field name="state" />
								<button name="action_assign" string="Confirm picking"
									type="object" icon="fa-check text-success"
									attrs="{'invisible': [('state', 'in', ('done', 'cancel', 'confirmed', 'assigned'))]}" />
								<button name="action_cancel" string="Cancel picking"
									type="object" icon="fa-times-circle text-danger"
									attrs="{'invisible': [('state', 'in', ('done', 'cancel'))]}" />
							</tree>
						</field>
					</group>

				</form>
			</xpath>
		</field>
	</record>
</odoo>
