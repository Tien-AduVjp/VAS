<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<record id="quality_alert_view_tree" model="ir.ui.view">
		<field name="name">quality.alert.tree</field>
		<field name="model">quality.alert</field>
		<field name="arch" type="xml">
			<tree>
				<field name="name" />
				<field name="product_tmpl_id" />
				<field name="product_id" groups="product.group_product_variant" />
				<field name="check_id" />
				<field name="stage_id" />
			</tree>
		</field>
	</record>
	
	<record id="quality_alert_view_form" model="ir.ui.view">
		<field name="name">quality.alert.form</field>
		<field name="model">quality.alert</field>
		<field name="arch" type="xml">
			<form>
				<header>
					<field name="stage_id" widget="statusbar" options="{'clickable': 1,'fold_field': 'folded'}" />
				</header>
				<sheet>
					<div class="oe_button_box">
						<button name="action_view_quality_check" type="object"
							attrs="{'invisible': [('check_id', '=', False)]}"
							class="oe_stat_button" icon="fa-check-square-o">
							<div class="o_form_field o_stat_info">
								<span class="o_stat_value">
									<field name="check_id" readonly="1" />
								</span>
								<span class="o_stat_text">Quality Check</span>
							</div>
						</button>
					</div>
					<div class="oe_title">
						<h1>
							<field name="name" readonly="1" />
						</h1>
					</div>
					<group>
						<group name="product">
							<field name="product_tmpl_id" />
							<field name="product_id"
								groups="product.group_product_variant" />
						</group>
						<group name="other">
							<field name="team_id" />
							<field name="user_id" />
							<field name="tag_ids" widget="many2many_tags"
								options="{'color_field': 'color'}" />
							<field name="reason_id" />
							<field name="priority" widget="priority" />
						</group>
					</group>
					<notebook>
						<page name="description" string="Description">
							<field name="description"
								placeholder="Description of the issue..." />
						</page>
						<page name="corrective_actions" string="Corrective Actions">
							<field name="action_corrective_ids">
								<tree string="Corrective Actions" nolable="1"
									editable="bottom">
									<field name="sequence" widget="handle" />
									<field name="quality_action_id" />
									<field name="user_id" />
									<field name="deadline" />
									<field name="product_tmpl_id" />
								</tree>
							</field>
						</page>
						<page name="preventive_actions" string="Preventive Actions">
							<field name="action_preventive_ids">
								<tree string="Preventive Actions" nolable="1"
									editable="bottom">
									<field name="sequence" widget="handle" />
									<field name="quality_action_id" />
									<field name="user_id" />
									<field name="deadline" />
									<field name="product_tmpl_id" />
								</tree>
							</field>
						</page>
						<page name="miscellaneous" string="Miscellaneous">
							<group>
								<group>
									<field name="partner_id" />
								</group>
								<group>
									<field name="date_assign" />
									<field name="date_close"
										attrs="{'invisible': [('date_close', '=', False)]}" />
								</group>
							</group>
						</page>
					</notebook>
				</sheet>
				<div class="oe_chatter">
					<field name="message_follower_ids" widget="mail_followers" />
					<field name="message_ids" widget="mail_thread" />
				</div>
			</form>
		</field>
	</record>
	
	<record id="quality_alert_view_search" model="ir.ui.view">
		<field name="name">quality.alert.search</field>
		<field name="model">quality.alert</field>
		<field name="arch" type="xml">
			<search string="Search Quality Alert">
				<field name="tag_ids" />
				<field name="product_id" />
				<field name="user_id" />
				<filter string="In progress" name="ftr_inprogress" domain="[('stage_id.done','=',False)]" />
				<filter string="Done" name="ftr_done" domain="[('stage_id.done','=',True)]" />
				<separator />
				<filter string="My Alerts" name="ftr_myalerts" domain="[('user_id','=',uid)]" />
				<group expand="0" string="Group By">
					<filter string="Stage" name="grp_stage_id" domain="[]" context="{'group_by':'stage_id'}" />
					<filter string="Responsible" name="grp_user_id" domain="[]" context="{'group_by':'user_id'}" />
					<filter string="Root Cause" name="grp_reason_id" domain="[]" context="{'group_by':'reason_id'}" />
					<filter string="Creation Date" name="grp_create_date" domain="[]" context="{'group_by':'create_date'}" />
				</group>
			</search>
		</field>
	</record>

	<record id="quality_alert_view_kanban" model="ir.ui.view">
		<field name="name">quality.alert.kanban</field>
		<field name="model">quality.alert</field>
		<field name="arch" type="xml">
			<kanban default_group_by="stage_id"
				class="o_kanban_small_column">
				<field name="description" />
				<field name="user_id" />
				<field name="stage_id" />
				<field name="tag_ids" />
				<field name="priority" />
				<templates>
					<t t-name="kanban-box">
						<div t-attf-class="oe_kanban_card oe_kanban_global_click">
							<div>
								<field name="tag_ids" />
							</div>
							<div>
								<strong>
									<field name="product_tmpl_id" />
								</strong>
							</div>
							<div>
								<field name="team_id" />
							</div>
							<div>
								<field name="display_name" />
							</div>
							<div class="oe_kanban_bottom_right">
								<img
									t-att-src="kanban_image('res.users', 'image_small', record.user_id.raw_value)"
									t-att-title="record.user_id.value"
									t-att-alt="record.user_id.value" width="24" height="24"
									class="oe_kanban_avatar float-right" />
							</div>
							<div class="oe_kanban_bottom_left">
								<field name="priority" widget="priority" />
							</div>
						</div>
					</t>
				</templates>
			</kanban>
		</field>
	</record>

	<record id="quality_alert_view_pivot" model="ir.ui.view">
		<field name="name">quality.alert.pivot</field>
		<field name="model">quality.alert</field>
		<field name="arch" type="xml">
			<pivot string="Quality Alert Analysis">
				<field name="stage_id" type="col" />
				<field name="team_id" type="row" />
			</pivot>
		</field>
	</record>

	<record id="quality_alert_view_graph" model="ir.ui.view">
		<field name="name">quality.alert.graph</field>
		<field name="model">quality.alert</field>
		<field name="arch" type="xml">
			<graph string="Quality Alert Analysis">
				<field name="reason_id" type="col" />
				<field name="stage_id" type="col" />
			</graph>
		</field>
	</record>

	<record id="quality_alert_view_calendar" model="ir.ui.view">
		<field name="name">quality.alert.calendar</field>
		<field name="model">quality.alert</field>
		<field name="priority" eval="2" />
		<field name="arch" type="xml">
			<calendar string="Quality Alert" date_start="date_assign"
				color="user_id" quick_add="false">
				<field name="user_id" />
				<field name="reason_id" />
			</calendar>
		</field>
	</record>

	<record id="quality_alert_action_team" model="ir.actions.act_window">
		<field name="name">Quality Alerts</field>
		<field name="res_model">quality.alert</field>
		<field name="view_mode">kanban,tree,form,pivot,graph,calendar</field>
		<field name="domain">[('team_id', '=', active_id)]</field>
		<field name="context">{'default_team_id': active_id, 'search_default_team_id': [active_id]}
		</field>
	</record>

	<record id="quality_alert_action_check" model="ir.actions.act_window">
		<field name="name">Quality Alerts</field>
		<field name="res_model">quality.alert</field>
		<field name="view_mode">kanban,tree,form,pivot,graph,calendar</field>
	</record>

	<record id="quality_alert_action_report" model="ir.actions.act_window">
		<field name="name">Quality Alerts</field>
		<field name="res_model">quality.alert</field>
		<field name="view_mode">graph,pivot,kanban,tree,form,calendar</field>
		<field name="help" type="html">
			<p>
				Create a new Quality Alerts.
			</p>
		</field>
	</record>

	<menuitem id="quality_alert_menu" action="quality_alert_action_check" parent="quality_alerts_menu" sequence="30" />
	<menuitem id="quality_alert_report_menu" action="quality_alert_action_report" parent="quality_reporting_menu" sequence="10" />

</odoo>
