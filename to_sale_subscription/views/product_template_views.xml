<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<record id="product_template_view_form" model="ir.ui.view">
		<field name="name">product.template.form</field>
		<field name="model">product.template</field>
		<field name="inherit_id" ref="product.product_template_form_view" />
		<field name="arch" type="xml">
			<page name="sales" position="attributes">
				<attribute name="attrs">{'invisible': [('sale_ok', '=', False),('recurring_invoice', '=', False)]}</attribute>
				<attribute name="class">page_sales</attribute>
			</page>
			<page name="sales" position="inside">
				<group name="subscription">
					<group>
						<field name="recurring_invoice" />
						<field name="subscription_template_id"
							class="field_sub_template_id"
							attrs="{'invisible': [('recurring_invoice', '=', False)],'required':[('recurring_invoice', '=', True)]}" />
					</group>
				</group>
			</page>

		</field>
	</record>

	<record id="product_template_view_search" model="ir.ui.view">
		<field name="name">product.template.search</field>
		<field name="model">product.template</field>
		<field name="inherit_id" ref="product.product_template_search_view" />
		<field name="arch" type="xml">
			<xpath expr="//filter[@name='filter_to_sell']" position="after">
				<filter name="ftr_recurring"
					string="Subscription products"
					domain="[('recurring_invoice', '=', True)]" />
			</xpath>
		</field>
	</record>

	<record id="product_template_action_subscription" model="ir.actions.act_window">
		<field name="name">Subscription Products</field>
		<field name="type">ir.actions.act_window</field>
		<field name="res_model">product.template</field>
		<field name="view_mode">kanban,tree,form</field>
		<field name="view_id" ref="product.product_template_tree_view" />
		<field name="search_view_id" ref="product_template_view_search" />
		<field name="context">{"default_recurring_invoice": True,"search_default_ftr_recurring": True}</field>
		<field name="help" type="html">
			<p class="oe_view_nocontent_create">
				Create a new product.
			</p>
			<p>
				You must define a product for everything you sell, whether it's
				a physical product, a consumable or a service you offer to
				customers.
			</p>
			<p>
				The product form contains information to simplify the sale process: 
				price, notes in the quotation, accounting data,
				procurement methods, etc.
			</p>
		</field>
	</record>

	<record id="product_template_action_all_subscription" model="ir.actions.act_window">
		<field name="name">Products</field>
		<field name="res_model">product.template</field>
		<field name="view_mode">tree,form</field>
		<field name="view_id" ref="product_template_view_search" />
		<field name="domain">[('subscription_template_id', '=', active_id)]</field>
		<field name="context">{'create':False}</field>
		<field name="help" type="html">
			<p>
				Find all the products related to this subscription template here.
			</p>
		</field>
	</record>

</odoo>
