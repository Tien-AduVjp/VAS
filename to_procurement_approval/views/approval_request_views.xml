<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		<record id="approval_request_view_form_inherit" model="ir.ui.view">
			<field name="name">approval.request.form.inherit</field>
			<field name="model">approval.request</field>
			<field name="inherit_id" ref="to_approvals.approval_request_view_form"/>
			<field name="arch" type="xml">
				<xpath expr="//field[@name='description']" position="after">
                    <field name="procurement_request_line_ids" attrs="{'invisible': [('type', '!=', 'procurement')]}">
						<tree editable="bottom">
							<field name="product_id" />
							<field name="description" />
							<field name="quantity" />
							<field name="uom_id" />
							<field name="type" invisible ="1"/>
							<field name="route_ids" widget="many2many_tags" groups="stock.group_adv_location" attrs="{'readonly': [('type', '=', 'service')],'column_invisible': [('parent.can_approve', '=', False)]}" />
							<field name="warehouse_id" attrs="{'readonly': [('type', '=', 'service')]}" />
							<field name="state" invisible="1" />
						</tree>
					</field>
                </xpath>
                <xpath expr="//div[@name='button_box']" position="inside">
                	<button name="action_view_procurement_groups"
								type="object" icon="fa-support" class="oe_stat_button"
								groups="stock.group_stock_user" help="Show all procurement groups that have been issued for this procurement request"
								attrs="{'invisible': [('procurement_groups_count', '=', 0),('type', '!=', 'procurement')]}">
						<field name="procurement_groups_count" widget="statinfo"
								string="Procurement Group" />
					</button>
					<button name="action_view_purchase_orders" type="object" class="oe_stat_button"
						groups="purchase.group_purchase_user,to_procurement_requests.group_user"
						icon="fa-pencil-square-o" help="Show all purchase orders that have been issued for this procurement request"
						attrs="{'invisible': [('type', '!=', 'procurement'),('purchase_orders_count', '=', 0)]}">
						<field name="purchase_orders_count" widget="statinfo"
							string="Purchase Orders" />
					</button>
					<button name="action_view_stock_pickings" type="object" class="oe_stat_button"
							groups="stock.group_stock_user,to_procurement_approval.group_user"
							icon="fa-truck" help="Show all tranfers that have been issued for this procurement request"
							attrs="{'invisible': [('type', '!=', 'procurement'),('pickings_count', '=', 0)]}">
						<field name="pickings_count" widget="statinfo"
							string="Picking" />
					</button>
				</xpath>
			</field>
		</record>
	</data>
</odoo>