from datetime import datetime, date
from odoo.tests.common import tagged
from .common import Common


@tagged('post_install', '-at_install')
class CashFlow(Common):
    
    def setUp(self): 
        super(CashFlow, self).setUp()
        self.AccountCashFlowReport = self.env.ref('to_account_reports_l10n_vn.af_dynamic_report_cashsummary_vn')
        
    def test_01_validate_cash_flow(self):
        # 01/08/2021
        journal_items_1 = [{
            'account_id': self.default_account_1121.id,
            'debit': 55000,
            'credit': 0,
            'partner_id': self.customer_a.id,
        },
        {
            'account_id': self.default_account_5111.id,
            'debit': 0,
            'credit': 50000,
            'tax_ids': [(6, 0, self.tax_price_vn_sale_10.ids)]
        },
        {
            'account_id': self.default_account_33311.id,
            'debit': 0,
            'credit': 5000,
            'tax_repartition_line_id': self.tax_repartition_line_vn_sale_10.id,
        }]
        journal_entry_1 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_sale, items=journal_items_1)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 0),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 55000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', 0),
            ('2.b. Expenditures paid to suppliers (Via Payables)', 0),
            ('Total 2. Expenditures paid to suppliers', 0),
            ('3. Expenditures paid to employees', 0),
            ('4. Paid interests', 0),
            ('5. Paid enterprise income tax', 0),
            ('6.a. Total Cash Received', 55000),
            ('6.b. Total Cash Received from cateogorized activities', 55000),
            ('Total 6. Other proceeds from operating activities', 0),
            ('7.a. Total Cash Out', 0),
            ('7.b. Total Cash Out from categorized activities', 0),
            ('Total 7. Other expenditures on operating activities', 0),
            ('Total Net cash flows from operating activities', 55000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', 0),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', 0),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', 0),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 0),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', 0),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 0),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 0),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', 0),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', 0),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 0),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 0),
            ('Total 6. Proceed from equity investments in other entities', 0),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', 0),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', 55000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', 55000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_2 = [{
            'account_id': self.default_account_131.id,
            'debit': 176000,
            'credit': 0,
            'partner_id': self.customer_a.id,
        },
        {
            'account_id': self.default_account_5111.id,
            'debit': 0,
            'credit': 160000,
        },
        {
            'account_id': self.default_account_3331.id,
            'debit': 0,
            'credit': 16000,
        },
        {
            'account_id': self.default_account_1121.id,
            'debit': 88000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_131.id,
            'debit': 0,
            'credit': 88000,
        }]
        journal_entry_2 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_2)
        journal_items_2 = journal_entry_2.line_ids.filtered(lambda r: r.account_id.code.startswith('131'))
        if journal_items_2:
            journal_items_2.reconcile()
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', 0),
            ('2.b. Expenditures paid to suppliers (Via Payables)', 0),
            ('Total 2. Expenditures paid to suppliers', 0),
            ('3. Expenditures paid to employees', 0),
            ('4. Paid interests', 0),
            ('5. Paid enterprise income tax', 0),
            ('6.a. Total Cash Received', 143000),
            ('6.b. Total Cash Received from cateogorized activities', 143000),
            ('Total 6. Other proceeds from operating activities', 0),
            ('7.a. Total Cash Out', 0),
            ('7.b. Total Cash Out from categorized activities', 0),
            ('Total 7. Other expenditures on operating activities', 0),
            ('Total Net cash flows from operating activities', 143000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', 0),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', 0),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', 0),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 0),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', 0),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 0),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 0),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', 0),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', 0),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 0),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 0),
            ('Total 6. Proceed from equity investments in other entities', 0),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', 0),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', 143000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', 143000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_3 = [{
            'account_id': self.default_account_1111.id,
            'debit': 0,
            'credit': 66000,
        },
        {
            'account_id': self.default_account_1561.id,
            'debit': 60000,
            'credit': 0,
            'tax_ids': [(6, 0, self.tax_price_vn_purchase_10.ids)]
        },
        {
            'account_id': self.default_account_1331.id,
            'debit': 6000,
            'credit': 0,
            'tax_repartition_line_id': self.tax_repartition_line_vn_purchase_10.id,
        }]
        journal_entry_3 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_purchase, items=journal_items_3)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', 0),
            ('Total 2. Expenditures paid to suppliers', -66000),
            ('3. Expenditures paid to employees', 0),
            ('4. Paid interests', 0),
            ('5. Paid enterprise income tax', 0),
            ('6.a. Total Cash Received', 143000),
            ('6.b. Total Cash Received from cateogorized activities', 143000),
            ('Total 6. Other proceeds from operating activities', 0),
            ('7.a. Total Cash Out', -66000),
            ('7.b. Total Cash Out from categorized activities', -66000),
            ('Total 7. Other expenditures on operating activities', 0),
            ('Total Net cash flows from operating activities', 77000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', 0),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', 0),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', 0),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 0),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', 0),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 0),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 0),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', 0),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', 0),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 0),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 0),
            ('Total 6. Proceed from equity investments in other entities', 0),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', 0),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', 77000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', 77000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_5= [{
            'account_id': self.default_account_3341.id,
            'debit': 500000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_1121.id,
            'debit': 0,
            'credit': 500000,
        }]
        journal_entry_5 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_5)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', 0),
            ('Total 2. Expenditures paid to suppliers', -66000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', 0),
            ('5. Paid enterprise income tax', 0),
            ('6.a. Total Cash Received', 143000),
            ('6.b. Total Cash Received from cateogorized activities', 143000),
            ('Total 6. Other proceeds from operating activities', 0),
            ('7.a. Total Cash Out', -566000),
            ('7.b. Total Cash Out from categorized activities', -566000),
            ('Total 7. Other expenditures on operating activities', 0),
            ('Total Net cash flows from operating activities', -423000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', 0),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', 0),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', 0),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 0),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', 0),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 0),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 0),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', 0),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', 0),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 0),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 0),
            ('Total 6. Proceed from equity investments in other entities', 0),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', 0),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -423000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -423000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_6 = [{
            'account_id': self.default_account_635.id,
            'debit': 10000,
            'credit': 0,
            'analytic_tag_ids': [(6, 0, self.analytic_tag_borrowing_loan.ids)]
        },
        {
            'account_id': self.default_account_331.id,
            'debit': 0,
            'credit': 10000,
            'partner_id': self.vendor_a.id,
        },
        {
            'account_id': self.default_account_1121.id,
            'debit': 0,
            'credit': 10000,
        },
        {
            'account_id': self.default_account_331.id,
            'debit': 10000,
            'credit': 0,
            'partner_id': self.vendor_a.id,
        }]
        journal_entry_6 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_6)
        journal_items_6 = journal_entry_6.line_ids.filtered(lambda r: r.account_id.code.startswith('331'))
        if journal_items_6:
            journal_items_6.reconcile()
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', 0),
            ('Total 2. Expenditures paid to suppliers', -66000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', 0),
            ('6.a. Total Cash Received', 143000),
            ('6.b. Total Cash Received from cateogorized activities', 143000),
            ('Total 6. Other proceeds from operating activities', 0),
            ('7.a. Total Cash Out', -576000),
            ('7.b. Total Cash Out from categorized activities', -576000),
            ('Total 7. Other expenditures on operating activities', 0),
            ('Total Net cash flows from operating activities', -433000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', 0),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', 0),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', 0),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 0),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', 0),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 0),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 0),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', 0),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', 0),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 0),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 0),
            ('Total 6. Proceed from equity investments in other entities', 0),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', 0),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -433000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -433000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_7= [{
            'account_id': self.default_account_3334.id,
            'debit': 15000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_1121.id,
            'debit': 0,
            'credit': 15000,
        }]
        journal_entry_7 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_7)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', 0),
            ('Total 2. Expenditures paid to suppliers', -66000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 143000),
            ('6.b. Total Cash Received from cateogorized activities', 143000),
            ('Total 6. Other proceeds from operating activities', 0),
            ('7.a. Total Cash Out', -591000),
            ('7.b. Total Cash Out from categorized activities', -591000),
            ('Total 7. Other expenditures on operating activities', 0),
            ('Total Net cash flows from operating activities', -448000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', 0),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', 0),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', 0),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 0),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', 0),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 0),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 0),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', 0),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', 0),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 0),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 0),
            ('Total 6. Proceed from equity investments in other entities', 0),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', 0),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -448000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -448000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_8= [{
            'account_id': self.default_account_2112.id,
            'debit': 500000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_1121.id,
            'debit': 0,
            'credit': 500000,
        }]
        journal_entry_8 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_8)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', 0),
            ('Total 2. Expenditures paid to suppliers', -66000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 143000),
            ('6.b. Total Cash Received from cateogorized activities', 143000),
            ('Total 6. Other proceeds from operating activities', 0),
            ('7.a. Total Cash Out', -1091000),
            ('7.b. Total Cash Out from categorized activities', -1091000),
            ('Total 7. Other expenditures on operating activities', 0),
            ('Total Net cash flows from operating activities', -448000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', 0),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -500000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 0),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', 0),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 0),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 0),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', 0),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', 0),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 0),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 0),
            ('Total 6. Proceed from equity investments in other entities', 0),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', -500000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -948000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -948000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_9 = [{
            'account_id': self.default_account_2112.id,
            'debit': 500000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_331.id,
            'debit': 0,
            'credit': 500000,
            'partner_id': self.vendor_a.id,
        },
        {
            'account_id': self.default_account_1121.id,
            'debit': 0,
            'credit': 500000,
        },
        {
            'account_id': self.default_account_331.id,
            'debit': 500000,
            'credit': 0,
            'partner_id': self.vendor_a.id,
        }]
        journal_entry_9 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_9)
        journal_items_9 = journal_entry_9.line_ids.filtered(lambda r: r.account_id.code.startswith('331'))
        if journal_items_9:
            journal_items_9.reconcile()
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', 0),
            ('Total 2. Expenditures paid to suppliers', -66000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 143000),
            ('6.b. Total Cash Received from cateogorized activities', 143000),
            ('Total 6. Other proceeds from operating activities', 0),
            ('7.a. Total Cash Out', -1591000),
            ('7.b. Total Cash Out from categorized activities', -1591000),
            ('Total 7. Other expenditures on operating activities', 0),
            ('Total Net cash flows from operating activities', -448000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 0),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', 0),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 0),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 0),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', 0),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', 0),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 0),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 0),
            ('Total 6. Proceed from equity investments in other entities', 0),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', -1000000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -1448000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -1448000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_10 = [{
            'account_id': self.default_account_1111.id,
            'debit': 50000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_711.id,
            'debit': 0,
            'credit': 50000,
            'analytic_tag_ids': [(6, 0, self.analytic_tag_fixed_assets.ids)]
        },
        {
            'account_id': self.default_account_2141.id,
            'debit': 80000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_811.id,
            'debit': 20000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_2111.id,
            'debit': 0,
            'credit': 100000,
        }]
        journal_entry_10 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_10)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', 0),
            ('Total 2. Expenditures paid to suppliers', -66000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 193000),
            ('6.b. Total Cash Received from cateogorized activities', 193000),
            ('Total 6. Other proceeds from operating activities', 0),
            ('7.a. Total Cash Out', -1591000),
            ('7.b. Total Cash Out from categorized activities', -1591000),
            ('Total 7. Other expenditures on operating activities', 0),
            ('Total Net cash flows from operating activities', -448000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 0),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', 0),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 50000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 0),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', 0),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', 0),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 0),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 0),
            ('Total 6. Proceed from equity investments in other entities', 0),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', -950000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -1398000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -1398000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_11 = [{
            'account_id': self.default_account_131.id,
            'debit': 50000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_711.id,
            'debit': 0,
            'credit': 50000,
            'analytic_tag_ids': [(6, 0, self.analytic_tag_fixed_assets.ids)]
        },
        {
            'account_id': self.default_account_2141.id,
            'debit': 80000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_811.id,
            'debit': 20000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_2111.id,
            'debit': 0,
            'credit': 100000,
        },
        {
            'account_id': self.default_account_1121.id,
            'debit': 50000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_131.id,
            'debit': 0,
            'credit': 50000,
        }]
        journal_entry_11 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_11)
        journal_items_11 = journal_entry_11.line_ids.filtered(lambda r: r.account_id.code.startswith('131'))
        if journal_items_11:
            journal_items_11.reconcile()
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', 0),
            ('Total 2. Expenditures paid to suppliers', -66000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 243000),
            ('6.b. Total Cash Received from cateogorized activities', 243000),
            ('Total 6. Other proceeds from operating activities', 0),
            ('7.a. Total Cash Out', -1591000),
            ('7.b. Total Cash Out from categorized activities', -1591000),
            ('Total 7. Other expenditures on operating activities', 0),
            ('Total Net cash flows from operating activities', -448000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', 0),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', 0),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 100000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 0),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', 0),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', 0),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 0),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 0),
            ('Total 6. Proceed from equity investments in other entities', 0),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', -900000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -1348000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -1348000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_12 = [{
            'account_id': self.default_account_811.id,
            'debit': 20000,
            'credit': 0,
            'analytic_tag_ids': [(6, 0, self.analytic_tag_fixed_assets.ids)]
        },
        {
            'account_id': self.default_account_1111.id,
            'debit': 0,
            'credit': 20000,
        }]
        journal_entry_12 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_12)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', 0),
            ('Total 2. Expenditures paid to suppliers', -66000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 243000),
            ('6.b. Total Cash Received from cateogorized activities', 223000),
            ('Total 6. Other proceeds from operating activities', 20000),
            ('7.a. Total Cash Out', -1611000),
            ('7.b. Total Cash Out from categorized activities', -1591000),
            ('Total 7. Other expenditures on operating activities', -20000),
            ('Total Net cash flows from operating activities', -448000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', -20000),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', 0),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 80000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 0),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', 0),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', 0),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 0),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 0),
            ('Total 6. Proceed from equity investments in other entities', 0),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', -920000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -1368000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -1368000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_13 = [{
            'account_id': self.default_account_811.id,
            'debit': 20000,
            'credit': 0,
            'analytic_tag_ids': [(6, 0, self.analytic_tag_fixed_assets.ids)]
        },
        {
            'account_id': self.default_account_331.id,
            'debit': 0,
            'credit': 20000,
        },
        {
            'account_id': self.default_account_331.id,
            'debit': 20000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_1111.id,
            'debit': 0,
            'credit': 20000,
        }]
        journal_entry_13 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_13)
        journal_items_13 = journal_entry_13.line_ids.filtered(lambda r: r.account_id.code.startswith('331'))
        if journal_items_13:
            journal_items_13.reconcile()
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', -20000),
            ('Total 2. Expenditures paid to suppliers', -86000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 243000),
            ('6.b. Total Cash Received from cateogorized activities', 203000),
            ('Total 6. Other proceeds from operating activities', 40000),
            ('7.a. Total Cash Out', -1631000),
            ('7.b. Total Cash Out from categorized activities', -1611000),
            ('Total 7. Other expenditures on operating activities', -20000),
            ('Total Net cash flows from operating activities', -448000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', -20000),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', -20000),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 60000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 0),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', 0),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', 0),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 0),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 0),
            ('Total 6. Proceed from equity investments in other entities', 0),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', -940000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -1388000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -1388000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_15 = [{
            'account_id': self.default_account_1121.id,
            'debit': 60000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_1283.id,
            'debit': 0,
            'credit': 60000,
            'analytic_tag_ids': [(6, 0, self.analytic_tag_lending_loan.ids)]
        }]
        journal_entry_15 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_15)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', -20000),
            ('Total 2. Expenditures paid to suppliers', -86000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 303000),
            ('6.b. Total Cash Received from cateogorized activities', 263000),
            ('Total 6. Other proceeds from operating activities', 40000),
            ('7.a. Total Cash Out', -1631000),
            ('7.b. Total Cash Out from categorized activities', -1611000),
            ('Total 7. Other expenditures on operating activities', -20000),
            ('Total Net cash flows from operating activities', -448000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', -20000),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', -20000),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 60000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 60000),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', 0),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', 0),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 0),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 0),
            ('Total 6. Proceed from equity investments in other entities', 0),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', -880000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -1328000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -1328000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_16 = [{
            'account_id': self.default_account_221.id,
            'debit': 700000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_1121.id,
            'debit': 0,
            'credit': 700000,
            'analytic_tag_ids': [(6, 0, self.analytic_tag_lending_loan.ids)]
        }]
        journal_entry_16 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_16)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', -20000),
            ('Total 2. Expenditures paid to suppliers', -86000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 303000),
            ('6.b. Total Cash Received from cateogorized activities', 263000),
            ('Total 6. Other proceeds from operating activities', 40000),
            ('7.a. Total Cash Out', -2331000),
            ('7.b. Total Cash Out from categorized activities', -2311000),
            ('Total 7. Other expenditures on operating activities', -20000),
            ('Total Net cash flows from operating activities', -448000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', -20000),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', -20000),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 60000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 60000),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', -700000),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', -700000),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 0),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 0),
            ('Total 6. Proceed from equity investments in other entities', 0),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', -1580000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -2028000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -2028000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_17 = [{
            'account_id': self.default_account_221.id,
            'debit': 400000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_331.id,
            'debit': 0,
            'credit': 400000,
            'partner_id': self.vendor_a.id,
        },
        {
            'account_id': self.default_account_331.id,
            'debit': 400000,
            'credit': 0,
            'partner_id': self.vendor_a.id,
        },
        {
            'account_id': self.default_account_1121.id,
            'debit': 0,
            'credit': 400000,
        }]
        journal_entry_17 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_17)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', -20000),
            ('Total 2. Expenditures paid to suppliers', -86000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 303000),
            ('6.b. Total Cash Received from cateogorized activities', 263000),
            ('Total 6. Other proceeds from operating activities', 40000),
            ('7.a. Total Cash Out', -2731000),
            ('7.b. Total Cash Out from categorized activities', -2311000),
            ('Total 7. Other expenditures on operating activities', -420000),
            ('Total Net cash flows from operating activities', -848000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', -20000),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', -20000),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 60000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 60000),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', -700000),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', -700000),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 0),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 0),
            ('Total 6. Proceed from equity investments in other entities', 0),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', -1580000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -2428000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -2428000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_18 = [{
            'account_id': self.default_account_1121.id,
            'debit': 700000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_221.id,
            'debit': 0,
            'credit': 700000,
        }]
        journal_entry_18 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_18)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', -20000),
            ('Total 2. Expenditures paid to suppliers', -86000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 1003000),
            ('6.b. Total Cash Received from cateogorized activities', 963000),
            ('Total 6. Other proceeds from operating activities', 40000),
            ('7.a. Total Cash Out', -2731000),
            ('7.b. Total Cash Out from categorized activities', -2311000),
            ('Total 7. Other expenditures on operating activities', -420000),
            ('Total Net cash flows from operating activities', -848000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', -20000),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', -20000),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 60000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 60000),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', -700000),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', -700000),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 700000),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 0),
            ('Total 6. Proceed from equity investments in other entities', 700000),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', -880000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -1728000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -1728000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_19 = [{
            'account_id': self.default_account_131.id,
            'debit': 700000,
            'credit': 0,
            'partner_id': self.customer_a.id,
        },
        {
            'account_id': self.default_account_221.id,
            'debit': 0,
            'credit': 700000,
        },
        {
            'account_id': self.default_account_1121.id,
            'debit': 700000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_131.id,
            'debit': 0,
            'credit': 700000,
            'partner_id': self.customer_a.id,
        }]
        journal_entry_19 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_19)
        journal_items_19 = journal_entry_19.line_ids.filtered(lambda r: r.account_id.code.startswith('131'))
        if journal_items_19:
            journal_items_19.reconcile()
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', -20000),
            ('Total 2. Expenditures paid to suppliers', -86000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 1703000),
            ('6.b. Total Cash Received from cateogorized activities', 1663000),
            ('Total 6. Other proceeds from operating activities', 40000),
            ('7.a. Total Cash Out', -2731000),
            ('7.b. Total Cash Out from categorized activities', -2311000),
            ('Total 7. Other expenditures on operating activities', -420000),
            ('Total Net cash flows from operating activities', -848000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', -20000),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', -20000),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 60000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 60000),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', -700000),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', -700000),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 700000),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 700000),
            ('Total 6. Proceed from equity investments in other entities', 1400000),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 0),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 0),
            ('Total Net cash flows from investing activities', -180000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -1028000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -1028000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_20 = [{
            'account_id': self.default_account_1121.id,
            'debit': 20000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_515.id,
            'debit': 0,
            'credit': 20000,
            'analytic_tag_ids': [(6, 0, self.analytic_tag_interests_dividends_distributed_profits.ids)]
        }]
        journal_entry_20 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_20)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', -20000),
            ('Total 2. Expenditures paid to suppliers', -86000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 1723000),
            ('6.b. Total Cash Received from cateogorized activities', 1683000),
            ('Total 6. Other proceeds from operating activities', 40000),
            ('7.a. Total Cash Out', -2731000),
            ('7.b. Total Cash Out from categorized activities', -2311000),
            ('Total 7. Other expenditures on operating activities', -420000),
            ('Total Net cash flows from operating activities', -848000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', -20000),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', -20000),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 60000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 60000),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', -700000),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', -700000),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 700000),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 700000),
            ('Total 6. Proceed from equity investments in other entities', 1400000),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 20000),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 20000),
            ('Total Net cash flows from investing activities', -160000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 0),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 0),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -1008000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -1008000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_22 = [{
            'account_id': self.default_account_1121.id,
            'debit': 500000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_4111.id,
            'debit': 0,
            'credit': 500000,
        }]
        journal_entry_22 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_22)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', -20000),
            ('Total 2. Expenditures paid to suppliers', -86000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 2223000),
            ('6.b. Total Cash Received from cateogorized activities', 2183000),
            ('Total 6. Other proceeds from operating activities', 40000),
            ('7.a. Total Cash Out', -2731000),
            ('7.b. Total Cash Out from categorized activities', -2311000),
            ('Total 7. Other expenditures on operating activities', -420000),
            ('Total Net cash flows from operating activities', -848000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', -20000),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', -20000),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 60000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 60000),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', -700000),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', -700000),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 700000),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 700000),
            ('Total 6. Proceed from equity investments in other entities', 1400000),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 20000),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 20000),
            ('Total Net cash flows from investing activities', -160000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 500000),
            ('2. Repayment of contributed capital and repurchase of stock issued', 0),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 500000),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -508000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -508000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_23 = [{
            'account_id': self.default_account_4111.id,
            'debit': 200000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_1121.id,
            'debit': 0,
            'credit': 200000,
        }]
        journal_entry_23 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_23)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', -20000),
            ('Total 2. Expenditures paid to suppliers', -86000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 2223000),
            ('6.b. Total Cash Received from cateogorized activities', 2183000),
            ('Total 6. Other proceeds from operating activities', 40000),
            ('7.a. Total Cash Out', -2931000),
            ('7.b. Total Cash Out from categorized activities', -2511000),
            ('Total 7. Other expenditures on operating activities', -420000),
            ('Total Net cash flows from operating activities', -848000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', -20000),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', -20000),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 60000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 60000),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', -700000),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', -700000),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 700000),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 700000),
            ('Total 6. Proceed from equity investments in other entities', 1400000),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 20000),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 20000),
            ('Total Net cash flows from investing activities', -160000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 500000),
            ('2. Repayment of contributed capital and repurchase of stock issued', -200000),
            ('3. Proceeds from borrowings', 0),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 300000),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -708000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -708000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_24 = [{
            'account_id': self.default_account_1121.id,
            'debit': 100000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_3411.id,
            'debit': 0,
            'credit': 100000,
        }]
        journal_entry_24 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_24)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', -20000),
            ('Total 2. Expenditures paid to suppliers', -86000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 2323000),
            ('6.b. Total Cash Received from cateogorized activities', 2283000),
            ('Total 6. Other proceeds from operating activities', 40000),
            ('7.a. Total Cash Out', -2931000),
            ('7.b. Total Cash Out from categorized activities', -2511000),
            ('Total 7. Other expenditures on operating activities', -420000),
            ('Total Net cash flows from operating activities', -848000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', -20000),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', -20000),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 60000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 60000),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', -700000),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', -700000),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 700000),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 700000),
            ('Total 6. Proceed from equity investments in other entities', 1400000),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 20000),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 20000),
            ('Total Net cash flows from investing activities', -160000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 500000),
            ('2. Repayment of contributed capital and repurchase of stock issued', -200000),
            ('3. Proceeds from borrowings', 100000),
            ('4. Repayment of principal', 0),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 400000),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -608000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -608000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_25 = [{
            'account_id': self.default_account_3411.id,
            'debit': 100000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_1121.id,
            'debit': 0,
            'credit': 100000,
        }]
        journal_entry_25 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_25)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', -20000),
            ('Total 2. Expenditures paid to suppliers', -86000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 2323000),
            ('6.b. Total Cash Received from cateogorized activities', 2283000),
            ('Total 6. Other proceeds from operating activities', 40000),
            ('7.a. Total Cash Out', -3031000),
            ('7.b. Total Cash Out from categorized activities', -2611000),
            ('Total 7. Other expenditures on operating activities', -420000),
            ('Total Net cash flows from operating activities', -848000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', -20000),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', -20000),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 60000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 60000),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', -700000),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', -700000),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 700000),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 700000),
            ('Total 6. Proceed from equity investments in other entities', 1400000),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 20000),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 20000),
            ('Total Net cash flows from investing activities', -160000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 500000),
            ('2. Repayment of contributed capital and repurchase of stock issued', -200000),
            ('3. Proceeds from borrowings', 100000),
            ('4. Repayment of principal', -100000),
            ('5. Repayment of financial principal', 0),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 300000),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -708000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -708000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_26 = [{
            'account_id': self.default_account_3412.id,
            'debit': 50000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_1121.id,
            'debit': 0,
            'credit': 50000,
        }]
        journal_entry_26 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_26)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', -20000),
            ('Total 2. Expenditures paid to suppliers', -86000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 2323000),
            ('6.b. Total Cash Received from cateogorized activities', 2283000),
            ('Total 6. Other proceeds from operating activities', 40000),
            ('7.a. Total Cash Out', -3081000),
            ('7.b. Total Cash Out from categorized activities', -2661000),
            ('Total 7. Other expenditures on operating activities', -420000),
            ('Total Net cash flows from operating activities', -848000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', -20000),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', -20000),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 60000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 60000),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', -700000),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', -700000),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 700000),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 700000),
            ('Total 6. Proceed from equity investments in other entities', 1400000),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 20000),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 20000),
            ('Total Net cash flows from investing activities', -160000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 500000),
            ('2. Repayment of contributed capital and repurchase of stock issued', -200000),
            ('3. Proceeds from borrowings', 100000),
            ('4. Repayment of principal', -100000),
            ('5. Repayment of financial principal', -50000),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', 0),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', 0),
            ('Total Cash flows from financial activities', 250000),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -758000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -758000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_27 = [{
            'account_id': self.default_account_4212.id,
            'debit': 50000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_1111.id,
            'debit': 0,
            'credit': 50000,
        }]
        journal_entry_27 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_27)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', -20000),
            ('Total 2. Expenditures paid to suppliers', -86000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 2323000),
            ('6.b. Total Cash Received from cateogorized activities', 2283000),
            ('Total 6. Other proceeds from operating activities', 40000),
            ('7.a. Total Cash Out', -3131000),
            ('7.b. Total Cash Out from categorized activities', -2711000),
            ('Total 7. Other expenditures on operating activities', -420000),
            ('Total Net cash flows from operating activities', -848000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', -20000),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', -20000),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 60000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 60000),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', -700000),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', -700000),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 700000),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 700000),
            ('Total 6. Proceed from equity investments in other entities', 1400000),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 20000),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 20000),
            ('Total Net cash flows from investing activities', -160000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 500000),
            ('2. Repayment of contributed capital and repurchase of stock issued', -200000),
            ('3. Proceeds from borrowings', 100000),
            ('4. Repayment of principal', -100000),
            ('5. Repayment of financial principal', -50000),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', -50000),
            ('6.b. Dividends and profits paid to owners (Via Payables)', 0),
            ('Total 6. Dividends and profits paid to owners', -50000),
            ('Total Cash flows from financial activities', 200000),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -808000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -808000),
        ]
        self._check_report_value(lines, table_value)
        
        # 01/08/2021
        journal_items_28 = [{
            'account_id': self.default_account_4212.id,
            'debit': 50000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_3388.id,
            'debit': 0,
            'credit': 50000,
            'partner_id': self.vendor_b.id,
        },
        {
            'account_id': self.default_account_3388.id,
            'debit': 50000,
            'credit': 0,
            'partner_id': self.vendor_b.id,
        },
        {
            'account_id': self.default_account_1111.id,
            'debit': 0,
            'credit': 50000,
        }]
        journal_entry_28 = self._init_journal_entry(None , datetime(2021, 8, 1, 12, 0), self.default_journal_vn_misc, items=journal_items_28)
        journal_items_28 = journal_entry_28.line_ids.filtered(lambda r: r.account_id.code.startswith('3388'))
        if journal_items_28:
            journal_items_28.reconcile()
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', -20000),
            ('Total 2. Expenditures paid to suppliers', -86000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 2323000),
            ('6.b. Total Cash Received from cateogorized activities', 2283000),
            ('Total 6. Other proceeds from operating activities', 40000),
            ('7.a. Total Cash Out', -3181000),
            ('7.b. Total Cash Out from categorized activities', -2761000),
            ('Total 7. Other expenditures on operating activities', -420000),
            ('Total Net cash flows from operating activities', -848000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', -20000),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', -20000),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 60000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 60000),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', -700000),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', -700000),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 700000),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 700000),
            ('Total 6. Proceed from equity investments in other entities', 1400000),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 20000),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 20000),
            ('Total Net cash flows from investing activities', -160000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 500000),
            ('2. Repayment of contributed capital and repurchase of stock issued', -200000),
            ('3. Proceeds from borrowings', 100000),
            ('4. Repayment of principal', -100000),
            ('5. Repayment of financial principal', -50000),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', -50000),
            ('6.b. Dividends and profits paid to owners (Via Payables)', -50000),
            ('Total 6. Dividends and profits paid to owners', -100000),
            ('Total Cash flows from financial activities', 150000),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -858000),
            ('Cash and cash equivalents, beginning of fiscal year', 0),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -858000),
        ]
        self._check_report_value(lines, table_value)
        
        # 09/08/2020
        journal_items_29 = [{
            'account_id': self.default_account_1121.id,
            'debit': 150000,
            'credit': 0,
        },
        {
            'account_id': self.default_account_4111.id,
            'debit': 0,
            'credit': 150000,
        }]
        journal_entry_29 = self._init_journal_entry(None , datetime(2020, 8, 9, 12, 0), self.default_journal_vn_misc, items=journal_items_29)
        lines = self._get_lines_report(self.AccountCashFlowReport, datetime(2021, 12, 30, 12, 0))
        table_value = [
            ('I. Cash flows from operating activities', 0),
            ('1a. Proceeds from sales and services rendered and other revenues (Cash Direct)', 55000),
            ('1b. Proceeds from sales and services rendered and other revenues (via receivables)', 88000),
            ('Total 1. Proceeds from sales and services rendered and other revenues', 143000),
            ('2.a. Expenditures paid to suppliers (Cash Direct)', -66000),
            ('2.b. Expenditures paid to suppliers (Via Payables)', -20000),
            ('Total 2. Expenditures paid to suppliers', -86000),
            ('3. Expenditures paid to employees', -500000),
            ('4. Paid interests', -10000),
            ('5. Paid enterprise income tax', -15000),
            ('6.a. Total Cash Received', 2323000),
            ('6.b. Total Cash Received from cateogorized activities', 2283000),
            ('Total 6. Other proceeds from operating activities', 40000),
            ('7.a. Total Cash Out', -3181000),
            ('7.b. Total Cash Out from categorized activities', -2761000),
            ('Total 7. Other expenditures on operating activities', -420000),
            ('Total Net cash flows from operating activities', -848000),
            ('II. Cash flows from investing activities', 0),
            ('1.a. Expenditures on purchase and construction of fixed assets and long-term assets (Cash Direct)', -500000),
            ('1.b. Expenditures on purchase and construction of fixed assets and long-term assets (Via Payables)', -500000),
            ('Total 1. Expenditures on purchase and construction of fixed assets and long-term assets', -1000000),
            ('2.a. Sales Revenue of fixed assets and other long-term assets (Cash Direct)', 50000),
            ('2.b. Sales Revenue of fixed assets and other long-term assets (Via Receivables)', 50000),
            ('2.c. Sales/Disposal Expenses of fixed assets and other long-term assets (Cash Direct)', -20000),
            ('2.d. Sales/Disposal Expenses of fixed assets and other long-term assets (Via Payables)', -20000),
            ('Total 2. Proceeds from disposal or transfer of fixed assets and other long-term assets', 60000),
            ('3. Expenditures on loans and purchase of  debt instruments from other entities', 0),
            ('4. Proceeds from lending or repurchase of debt instruments from other entities', 60000),
            ('5.a. Expenditures on equity investments in other entities (Cash Direct)', -700000),
            ('5.b. Expenditures on equity investments in other entities (Via Payables)', 0),
            ('Total 5. Expenditures on equity investments in other entities', -700000),
            ('6.a. Proceed from equity investments in other entities (Cash Direct)', 700000),
            ('6.b Proceed from equity investments in other entities (Via receivables)', 700000),
            ('Total 6. Proceed from equity investments in other entities', 1400000),
            ('7.a. Proceed from interests, dividends and distributed profits (Cash Direct)', 20000),
            ('7.b. Proceed from interests, dividends and distributed profits (Via Receivables)', 0),
            ('Total 7. Proceed from interests, dividends and distributed profits', 20000),
            ('Total Net cash flows from investing activities', -160000),
            ('III. Cash flows from financial activities', 0),
            ('1. Proceeds from issuance of shares and receipt of contributed capital', 500000),
            ('2. Repayment of contributed capital and repurchase of stock issued', -200000),
            ('3. Proceeds from borrowings', 100000),
            ('4. Repayment of principal', -100000),
            ('5. Repayment of financial principal', -50000),
            ('6.a. Dividends and profits paid to owners (Cash Direct)', -50000),
            ('6.b. Dividends and profits paid to owners (Via Payables)', -50000),
            ('Total 6. Dividends and profits paid to owners', -100000),
            ('Total Cash flows from financial activities', 150000),
            ('Total Net cash flows during the fiscal year (50 = 20+30+40)', -858000),
            ('Cash and cash equivalents, beginning of fiscal year', 150000),
            ('Effect of exchange rate fluctuations', 0),
            ('Cash and cash equivalents, end of fiscal year (70 = 50 + 60 + 61)', -708000),
        ]
        self._check_report_value(lines, table_value)
