<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<record id="personal_tax_rule_progress_view_form"
		model="ir.ui.view">
		<field name="name">personal.tax.rule.progress.form</field>
		<field name="model">personal.tax.rule.progress</field>
		<field name="arch" type="xml">
			<form string="Personal Tax Rule Escalation">
				<sheet>
					<group>
						<group>
							<field name="rule_id" />
							<field name="country_id" readonly="1" force_save="1" />
							<field name="currency_id" invisible="1" force_save="1" />
						</group>
						<group>
							<field name="base" />
							<field name="rate" />
						</group>
					</group>
				</sheet>
				<div class="oe_chatter">
					<field name="message_follower_ids" widget="mail_followers"
						groups="base.group_user" />
					<field name="message_ids" widget="mail_thread" />
				</div>
			</form>
		</field>
	</record>

	<record id="personal_tax_rule_view_form" model="ir.ui.view">
		<field name="name">personal.tax.rule.form</field>
		<field name="model">personal.tax.rule</field>
		<field name="arch" type="xml">
			<form string="Personal Tax Rule">
				<sheet>
					<group>
						<group>
							<field name="country_id" />
							<field name="currency_id" invisible="1" force_save="1" />
							<field name="personal_tax_policy" />
							<label for="personal_tax_flat_rate"
								attrs="{'invisible':[('personal_tax_policy','!=','flat_rate')]}" />
							<div class="o_row">
								<field name="personal_tax_flat_rate"
									attrs="{'required':[('personal_tax_policy','=','flat_rate')],'invisible':[('personal_tax_policy','!=','flat_rate')]}" />
								<span
									attrs="{'invisible':[('personal_tax_policy','!=','flat_rate')]}">%</span>
							</div>
						</group>
						<group>
							<field name="apply_tax_base_deduction" />
							<field name="personal_tax_base_ded"
								attrs="{'invisible':[('apply_tax_base_deduction','=',False)]}" />
							<field name="dependent_tax_base_ded"
								attrs="{'invisible':[('apply_tax_base_deduction','=',False)]}" />
						</group>
					</group>
					<notebook>
						<page string="Progressive Tax Table"
							attrs="{'invisible':[('personal_tax_policy','!=','escalation')]}">
							<field name="progress_ids">
								<tree editable="botton">
									<field name="currency_id" invisible="1" force_save="1" />
									<field name="base" />
									<field name="rate" string="Rate (%)" />
								</tree>
								<form>
									<group>
										<group>
											<field name="currency_id" invisible="1" force_save="1" />
											<field name="base" />
										</group>
										<group>
											<label for="rate" />
											<div class="o_row">
												<field name="rate" />
												<span>%</span>
											</div>
										</group>
									</group>
								</form>
							</field>
						</page>
					</notebook>
				</sheet>
				<div class="oe_chatter">
					<field name="message_follower_ids" widget="mail_followers"
						groups="base.group_user" />
					<field name="activity_ids" widget="mail_activity" />
					<field name="message_ids" widget="mail_thread" />
				</div>
			</form>
		</field>
	</record>

	<record id="personal_tax_rule_view_tree" model="ir.ui.view">
		<field name="name">personal.tax.rule.tree</field>
		<field name="model">personal.tax.rule</field>
		<field name="arch" type="xml">
			<tree string="Personal Tax Rule">
				<field name="sequence" widget="handle" />
				<field name="country_id" />
				<field name="personal_tax_policy" />
				<field name="personal_tax_flat_rate" string="Flat Rate (%)" />
				<field name="apply_tax_base_deduction" />
				<field name="progress_ids" widget="many2many_tags" />
			</tree>
		</field>
	</record>
	<record id="personal_tax_rule_view_filter" model="ir.ui.view">
		<field name="name">personal.tax.rule.search</field>
		<field name="model">personal.tax.rule</field>
		<field name="arch" type="xml">
			<search string="Personal Tax Rule">
				<field name="country_id" />
				<separator />
				<field name="personal_tax_policy" />
				<separator />
				<filter name="ftr_flat_rate" string="Flat Rate"
					domain="[('personal_tax_policy','=','flat_rate')]" />
				<filter name="ftr_escal" string="Progressive Tax Table"
					domain="[('personal_tax_policy','=','escalation')]" />
			</search>
		</field>
	</record>

	<record model="ir.actions.act_window" id="act_personal_tax_rule">
		<field name="name">Personal Tax Rules</field>
		<field name="res_model">personal.tax.rule</field>
		<field name="view_mode">tree,form</field>
	</record>

	<menuitem id="menu_personal_tax_rule"
		action="act_personal_tax_rule" parent="menu_hr_payroll_configuration"
		sequence="2" />
</odoo>