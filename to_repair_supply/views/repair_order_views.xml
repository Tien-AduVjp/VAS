<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		<record id="view_repair_order_form" model="ir.ui.view">
			<field name="name">repair.form</field>
			<field name="model">repair.order</field>
			<field name="inherit_id" ref="repair.view_repair_order_form" />
			<field name="arch" type="xml">
				<xpath expr="//form/group/group/field[@name='location_id']" position="attributes">
					<attribute name="force_save">1</attribute>
				</xpath>
				<xpath expr="//tree/field[@name='location_id']" position="attributes">
					<attribute name="force_save">1</attribute>
				</xpath>
				<xpath expr="//field[@name='state']" position="attributes">
					<attribute name="statusbar_visible">draft,confirmed,done,delivered</attribute>
				</xpath>
				<xpath expr="//button[@name='action_repair_cancel']" position="before">
                    <button name="%(wizard_repair_request_supply_action)d"
                        type="action" string="Request Supply"
                        attrs="{'invisible': [('state', 'in', ['draft','cancel','done','delivered'])]}"></button>
					<button name="%(action_consume_repair_order)d"
						type="action" string="Consume Parts"
						attrs="{'invisible': [('state', 'not in', ['under_repair'])]}"></button>
					<button name="action_delivery_confirm" type="object" string="Delivery Comfirm" attrs="{'invisible':[('state', 'not in',('done'))]}"/>
				</xpath>
				<xpath expr="//field[@name='operations']/tree/field[@name='location_id']"
					position="before">
					<field name="src_location_id"/>
				</xpath>
				<xpath expr="//field[@name='operations']/tree/field[@name='product_uom_qty']"
					position="after">
					<field name="consumed_qty" optional="hide" />
				</xpath>
				<xpath expr="//field[@name='repaired']/parent::group/preceding-sibling::group" position="inside">
					<field name="group_id" />
				</xpath>
				<xpath expr="//button[@name='action_created_invoice']"
					position="after">
					<field name="picking_ids" invisible="1" />
					<field name="move_ids" invisible="1" />
					<button type="object" name="action_view_delivery" class="oe_stat_button"
						icon="fa-truck" attrs="{'invisible': [('delivery_count', '=', 0)]}"
						groups="base.group_user">
						<field name="delivery_count" widget="statinfo" string="Transfers" />
					</button>
					<button type="object" name="action_view_product_move" class="oe_stat_button"
						icon="fa-arrows-h" attrs="{'invisible': [('move_count', '=', 0)]}"
						groups="base.group_user">
						<field name="move_count" widget="statinfo" string="Product Moves" />
					</button>
				</xpath>
				<xpath expr="//button[@name='action_repair_end']" position="attributes">
                    <attribute name="context">{'check_consumption': True}</attribute>
                </xpath>
			</field>
		</record>
	</data>
</odoo>
